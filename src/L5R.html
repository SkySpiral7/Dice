<!DOCTYPE HTML>
<html>
<head>
<title>L5R dice</title>
<meta charset="ASCII" />
<script id="DiceInclude" src="library/include.js"></script>
<script type="text/javaScript">
function rollDice()
{
   var input = {};
   input.circumstanceBonus = Number.parseInt(document.getElementById('circumstanceBonus').value);
   if(Number.isNaN(input.circumstanceBonus)) input.circumstanceBonus = undefined;
   input.numberOfRaises = Number.parseInt(document.getElementById('numberOfRaises').value);
   if(Number.isNaN(input.numberOfRaises)) input.numberOfRaises = undefined;
   input.targetNumber = Number.parseInt(document.getElementById('targetNumber').value);
   input.diceRolled = Number.parseInt(document.getElementById('diceRolled').value);
   input.diceKept = Number.parseInt(document.getElementById('diceKept').value);
   input.hasEmphasis = document.getElementById('hasEmphasis').checked;
   //TODO: next: more validation

   var result = Prebuilt.L5RGeneralRoll(input);

   document.getElementById('valuesKept').textContent = result.valuesKept;
   document.getElementById('valuesDropped').textContent = result.valuesDropped;
   document.getElementById('total').textContent = result.totalValue;
   document.getElementById('voidPointsRecovered').textContent = result.voidPointsRecovered;
   if(result.success) document.getElementById('success').textContent = 'Success';
   else document.getElementById('success').textContent = 'Failure';
}
function mainDraw()
{
   var input = {};
   input.diceRolled = Number.parseInt(document.getElementById('diceRolled').value);
   input.diceKept = Number.parseInt(document.getElementById('diceKept').value);
   input.hasEmphasis = document.getElementById('hasEmphasis').checked;
   Draw.diceBellCurve(new L5RDicePool(input));
}
</script>
</head>
<body>
<a>Warning: if you don't keep all dice then drawing (but not rolling) will be VERY slow (5k3 won't finish). Drawing ignores TN, circumstance, and raises.</a>
<form action="javascript:rollDice();">
<table>
   <tr>
      <td style="text-align:right;">Target Number:</td>
      <td><input type="text" size="1" id="targetNumber" /></td>
      <td style="text-align:right;">Values Kept:</td>
      <td><span id="valuesKept"></span></td>
   </tr>
   <tr>
      <td style="text-align:right;">Circumstance Bonus:</td>
      <td><input type="text" size="1" id="circumstanceBonus" value="0" /></td>
      <td style="text-align:right;">Values Dropped:</td>
      <td><span id="valuesDropped"></span></td>
   </tr>
   <tr>
      <td style="text-align:right;">Number of (non-free) Raises:</td>
      <td><input type="text" size="1" id="numberOfRaises" value="0" /></td>
      <td style="text-align:right;">Total:</td>
      <td><span id="total"></span></td>
   </tr>
   <tr>
      <td style="text-align:right;">Roll what?</td>
      <td><input type="text" size="1" id="diceRolled" /><a> k </a><input type="text" size="1" id="diceKept" /></td>
      <td />
      <td><span id="success">Result</span></td>
   </tr>
   <tr>
      <td style="text-align:right;">Emphasis</td>
      <td><input type="checkbox" id="hasEmphasis" /></td>
      <td style="text-align:right;">Void Points Recovered:</td>
      <td><span id="voidPointsRecovered"></span></td>
   </tr>
   <tr>
      <td style="text-align:right;"><input type="button" value="Draw" onClick="javascript:mainDraw();" /></td>
      <td><input type="submit" value="Roll" /></td>
      <td />
      <td />
   </tr>
</table>
</form>
<br />
<div id="graphResults"></div>
<br /><br /><br /><br />
</body>
</html>
